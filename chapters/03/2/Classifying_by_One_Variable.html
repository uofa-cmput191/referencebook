
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.2. Classifying by One Variable &#8212; Introduction to Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-148221575-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-148221575-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-148221575-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/03/2/Classifying_by_One_Variable';</script>
    <link rel="canonical" href="https://uofa-cmput191.github.io/referencebook/chapters/03/2/Classifying_by_One_Variable.html" />
    <link rel="icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="prev" title="3.1. Selecting and Sorting" href="../1/Index-Slice.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Introduction to Data Science - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Introduction to Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01/what-is-data-science.html">1. Data Science</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../01/1/intro.html">1.1. Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../01/1/1/computational-tools.html">1.1.1. Computational Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01/1/2/statistical-techniques.html">1.1.2. Statistical Techniques</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../01/2/why-data-science.html">1.2. Why Data Science?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/3/importance-and-impact-of-datascience.html">1.3. Importance and Impact of Data Science</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/4/applications-and%20use-cases.html">1.4. Key Applications and Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/5/Data_Science_Life_Cycle.html">1.5. Data Science Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01/6/Summary-1.html">1.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../02/causality-and-experiments.html">2. Causality and Experiments</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../02/1/observation-and-visualization-john-snow-and-the-broad-street-pump.html">2.1. John Snow and the Broad Street Pump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/2/snow-s-grand-experiment.html">2.2. Snow’s “Grand Experiment”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/3/establishing-causality.html">2.3. Establishing Causality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/4/randomization.html">2.4. Randomization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../02/5/endnote.html">2.5. Endnote</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../Tables.html">3. Working with Tabular Data</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../1/Index-Slice.html">3.1. Selecting and Sorting</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.2. Classifying by One Variable</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/uofa-cmput191/referencebook" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/chapters/03/2/Classifying_by_One_Variable.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Classifying by One Variable</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-the-number-in-each-category">3.2.1. Counting the Number in Each Category</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-a-characteristic-of-each-category">3.2.2. Finding a Characteristic of Each Category</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-nhl-salaries">3.2.3. Example: NHL Salaries</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_remove-input docutils container">
</div>
<section class="tex2jax_ignore mathjax_ignore" id="classifying-by-one-variable">
<h1><span class="section-number">3.2. </span>Classifying by One Variable<a class="headerlink" href="#classifying-by-one-variable" title="Link to this heading">#</a></h1>
<p>Data scientists often need to classify individuals into groups according to shared features, and then identify some characteristics of the groups. For example, in the top movies dataset, it’s common to ask:</p>
<p><strong>What was the total gross in each year?</strong></p>
<p>This type of question involves classifying individuals into categories that are not numerical. To classify individuals into categories we use <strong>grouping</strong>.</p>
<section id="counting-the-number-in-each-category">
<h2><span class="section-number">3.2.1. </span>Counting the Number in Each Category<a class="headerlink" href="#counting-the-number-in-each-category" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">group</span></code> method with a single argument counts the number of rows for each category in a column. The result contains one row per unique value in the grouped column.</p>
<p>Here is a small table of data on ice cream cones. The <code class="docutils literal notranslate"><span class="pre">group</span></code> method can be used to list the distinct flavors and provide the counts of each flavor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cones</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;strawberry&#39;</span><span class="p">,</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span> <span class="s1">&#39;strawberry&#39;</span><span class="p">,</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="mf">3.55</span><span class="p">,</span> <span class="mf">4.75</span><span class="p">,</span> <span class="mf">6.55</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">cones</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>Price</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>strawberry</td> <td>3.55 </td>
        </tr>
        <tr>
            <td>chocolate </td> <td>4.75 </td>
        </tr>
        <tr>
            <td>chocolate </td> <td>6.55 </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>5.25 </td>
        </tr>
        <tr>
            <td>chocolate </td> <td>5.25 </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cones</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>count</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>chocolate </td> <td>3    </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>2    </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>There are two distinct categories, chocolate and strawberry. The call to <code class="docutils literal notranslate"><span class="pre">group</span></code> creates a table of counts in each category. The column is called <code class="docutils literal notranslate"><span class="pre">count</span></code> by default, and contains the number of rows in each category.</p>
<p>Notice that this can all be worked out from just the <code class="docutils literal notranslate"><span class="pre">Flavor</span></code> column. The <code class="docutils literal notranslate"><span class="pre">Price</span></code> column has not been used.</p>
<p>But what if we wanted the total price of the cones of each different flavor? That’s where the second argument of <code class="docutils literal notranslate"><span class="pre">group</span></code> comes in.</p>
</section>
<section id="finding-a-characteristic-of-each-category">
<h2><span class="section-number">3.2.2. </span>Finding a Characteristic of Each Category<a class="headerlink" href="#finding-a-characteristic-of-each-category" title="Link to this heading">#</a></h2>
<p>The optional second argument of <code class="docutils literal notranslate"><span class="pre">group</span></code> names the function that will be used to aggregate values in other columns for all of those rows. For instance, <code class="docutils literal notranslate"><span class="pre">sum</span></code> will sum up the prices in all rows that match each category. This result also contains one row per unique value in the grouped column, but it has the same number of columns as the original table.</p>
<p>To find the total price of each flavor, we call <code class="docutils literal notranslate"><span class="pre">group</span></code> again, with <code class="docutils literal notranslate"><span class="pre">Flavor</span></code> as its first argument as before. But this time there is a second argument: the function name <code class="docutils literal notranslate"><span class="pre">sum</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cones</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>Price sum</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>chocolate </td> <td>16.55    </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>8.8      </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>To create this new table, <code class="docutils literal notranslate"><span class="pre">group</span></code> has calculated the sum of the <code class="docutils literal notranslate"><span class="pre">Price</span></code> entries in all the rows corresponding to each distinct flavor. The prices in the three <code class="docutils literal notranslate"><span class="pre">chocolate</span></code> rows add up to <span class="math notranslate nohighlight">\(\$16.55\)</span> (you can assume that price is being measured in dollars). The prices in the two <code class="docutils literal notranslate"><span class="pre">strawberry</span></code> rows have a total of <span class="math notranslate nohighlight">\(\$8.80\)</span>.</p>
<p>The label of the newly created “sum” column is <code class="docutils literal notranslate"><span class="pre">Price</span> <span class="pre">sum</span></code>, which is created by taking the label of the column being summed, and appending the word <code class="docutils literal notranslate"><span class="pre">sum</span></code>.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">group</span></code> finds the <code class="docutils literal notranslate"><span class="pre">sum</span></code> of all columns other than the one with the categories, there is no need to specify that it has to <code class="docutils literal notranslate"><span class="pre">sum</span></code> the prices.</p>
<p>To see in more detail what <code class="docutils literal notranslate"><span class="pre">group</span></code> is doing, notice that you could have figured out the total prices yourself, not only by mental arithmetic but also using code. For example, to find the total price of all the chocolate cones, you could start by creating a new table consisting of only the chocolate cones, and then accessing the column of prices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cones</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="s1">&#39;chocolate&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 4.75,  6.55,  5.25])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">cones</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="s1">&#39;chocolate&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.550000000000001
</pre></div>
</div>
</div>
</div>
<p>This is what <code class="docutils literal notranslate"><span class="pre">group</span></code> is doing for each distinct value in <code class="docutils literal notranslate"><span class="pre">Flavor</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For each distinct value in `Flavor, access all the rows</span>
<span class="c1"># and create an array of `Price`</span>

<span class="n">cones_choc</span> <span class="o">=</span> <span class="n">cones</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="s1">&#39;chocolate&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
<span class="n">cones_strawb</span> <span class="o">=</span> <span class="n">cones</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="s1">&#39;strawberry&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>

<span class="c1"># Display the arrays in a table</span>

<span class="n">grouped_cones</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="s1">&#39;chocolate&#39;</span><span class="p">,</span> <span class="s1">&#39;strawberry&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Array of All the Prices&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="n">cones_choc</span><span class="p">,</span> <span class="n">cones_strawb</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Append a column with the sum of the `Price` values in each array</span>

<span class="n">price_totals</span> <span class="o">=</span> <span class="n">grouped_cones</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s1">&#39;Sum of the Array&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">cones_choc</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cones_strawb</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">price_totals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>Array of All the Prices</th> <th>Sum of the Array</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>chocolate </td> <td>[ 4.75  6.55  5.25]    </td> <td>16.55           </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>[ 3.55  5.25]          </td> <td>8.8             </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>You can replace <code class="docutils literal notranslate"><span class="pre">sum</span></code> by any other functions that work on arrays. For example, you could use <code class="docutils literal notranslate"><span class="pre">max</span></code> to find the largest price in each category:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cones</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="nb">max</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>Price max</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>chocolate </td> <td>6.55     </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>5.25     </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>Once again, <code class="docutils literal notranslate"><span class="pre">group</span></code> creates arrays of the prices in each <code class="docutils literal notranslate"><span class="pre">Flavor</span></code> category. But now it finds the <code class="docutils literal notranslate"><span class="pre">max</span></code> of each array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">price_maxes</span> <span class="o">=</span> <span class="n">grouped_cones</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s1">&#39;Max of the Array&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">cones_choc</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">cones_strawb</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">price_maxes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>Array of All the Prices</th> <th>Max of the Array</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>chocolate </td> <td>[ 4.75  6.55  5.25]    </td> <td>6.55            </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>[ 3.55  5.25]          </td> <td>5.25            </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>Indeed, the original call to <code class="docutils literal notranslate"><span class="pre">group</span></code> with just one argument has the same effect as using <code class="docutils literal notranslate"><span class="pre">len</span></code> as the function and then cleaning up the table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lengths</span> <span class="o">=</span> <span class="n">grouped_cones</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s1">&#39;Length of the Array&#39;</span><span class="p">,</span> <span class="n">make_array</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cones_choc</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">cones_strawb</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">lengths</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Flavor</th> <th>Array of All the Prices</th> <th>Length of the Array</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>chocolate </td> <td>[ 4.75  6.55  5.25]    </td> <td>3                  </td>
        </tr>
        <tr>
            <td>strawberry</td> <td>[ 3.55  5.25]          </td> <td>2                  </td>
        </tr>
    </tbody>
</table></div></div>
</div>
</section>
<section id="example-nhl-salaries">
<h2><span class="section-number">3.2.3. </span>Example: NHL Salaries<a class="headerlink" href="#example-nhl-salaries" title="Link to this heading">#</a></h2>
<p>The table <code class="docutils literal notranslate"><span class="pre">nhl</span></code> contains data on the 2023-2024 players in the National Hockey League. We will answer some datascience questions about this dataset using grouping.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nhl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Name</th> <th>Team</th> <th>Position</th> <th>Salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Nathan MacKinnon</td> <td>COL </td> <td>C       </td> <td>12600000</td>
        </tr>
        <tr>
            <td>Connor McDavid  </td> <td>EDM </td> <td>C       </td> <td>12500000</td>
        </tr>
        <tr>
            <td>Artemi Panarin  </td> <td>NYR </td> <td>LW      </td> <td>11642857</td>
        </tr>
        <tr>
            <td>Auston Matthews </td> <td>TOR </td> <td>C       </td> <td>11640250</td>
        </tr>
        <tr>
            <td>Erik Karlsson   </td> <td>PIT </td> <td>D       </td> <td>11500000</td>
        </tr>
        <tr>
            <td>David Pastrnak  </td> <td>BOS </td> <td>RW      </td> <td>11250000</td>
        </tr>
        <tr>
            <td>Drew Doughty    </td> <td>LAK </td> <td>D       </td> <td>11000000</td>
        </tr>
        <tr>
            <td>John Tavares    </td> <td>TOR </td> <td>C       </td> <td>11000000</td>
        </tr>
        <tr>
            <td>Mitchell Marner </td> <td>TOR </td> <td>RW      </td> <td>10903000</td>
        </tr>
        <tr>
            <td>Carey Price     </td> <td>MTL </td> <td>G       </td> <td>10500000</td>
        </tr>
    </tbody>
</table>
<p>... (791 rows omitted)</p></div></div>
</div>
<p><strong>1.</strong> How much money did each team pay for its players’ salaries?</p>
<p>The only columns involved are <code class="docutils literal notranslate"><span class="pre">Team</span></code> and <code class="docutils literal notranslate"><span class="pre">Salary</span></code>. We have to <code class="docutils literal notranslate"><span class="pre">group</span></code> the rows by <code class="docutils literal notranslate"><span class="pre">Team</span></code> and then <code class="docutils literal notranslate"><span class="pre">sum</span></code> the salaries of the groups.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">teams_and_money</span> <span class="o">=</span> <span class="n">nhl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">)</span>
<span class="n">teams_and_money</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Team</th> <th>Salary sum</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>ANA </td> <td>68864167  </td>
        </tr>
        <tr>
            <td>ARI </td> <td>65684872  </td>
        </tr>
        <tr>
            <td>BOS </td> <td>85920000  </td>
        </tr>
        <tr>
            <td>BUF </td> <td>71523570  </td>
        </tr>
        <tr>
            <td>CAR </td> <td>95409417  </td>
        </tr>
        <tr>
            <td>CBJ </td> <td>75754166  </td>
        </tr>
        <tr>
            <td>CGY </td> <td>72827500  </td>
        </tr>
        <tr>
            <td>CHI </td> <td>58468333  </td>
        </tr>
        <tr>
            <td>COL </td> <td>88550000  </td>
        </tr>
        <tr>
            <td>DAL </td> <td>87196667  </td>
        </tr>
    </tbody>
</table>
<p>... (22 rows omitted)</p></div></div>
</div>
<p><strong>2.</strong> How many NHL players were there in each of the five positions?</p>
<p>We have to classify by <code class="docutils literal notranslate"><span class="pre">Position</span></code>, and count. This can be done with just one argument to group:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nhl</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Position</th> <th>count</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>C       </td> <td>240  </td>
        </tr>
        <tr>
            <td>D       </td> <td>260  </td>
        </tr>
        <tr>
            <td>G       </td> <td>73   </td>
        </tr>
        <tr>
            <td>LW      </td> <td>130  </td>
        </tr>
        <tr>
            <td>RW      </td> <td>98   </td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p><strong>3.</strong> What was the average salary of the players at each of the five positions?</p>
<p>This time, we have to group by <code class="docutils literal notranslate"><span class="pre">Position</span></code> and take the mean of the salaries. For clarity, we will work with a table of just the positions and the salaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">positions_and_money</span> <span class="o">=</span> <span class="n">nhl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">)</span>
<span class="n">positions_and_money</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Position</th> <th>Salary mean</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>C       </td> <td>3.41948e+06</td>
        </tr>
        <tr>
            <td>D       </td> <td>3.19945e+06</td>
        </tr>
        <tr>
            <td>G       </td> <td>3.0182e+06 </td>
        </tr>
        <tr>
            <td>LW      </td> <td>3.29887e+06</td>
        </tr>
        <tr>
            <td>RW      </td> <td>3.02728e+06</td>
        </tr>
    </tbody>
</table></div></div>
</div>
<p>Center was the most highly paid position, at an average of over 3 million dollars.</p>
<p>If we had not selected the two columns as our first step, <code class="docutils literal notranslate"><span class="pre">group</span></code> would not attempt to “average” the categorical columns in <code class="docutils literal notranslate"><span class="pre">nhl</span></code>. (It is impossible to average two strings like “Nathan MacKinnon” and “Connor McDavid”.) It performs arithmetic only on numerical columns and leaves the rest blank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nhl</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
    <thead>
        <tr>
            <th>Position</th> <th>Name mean</th> <th>Team mean</th> <th>Salary mean</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>C       </td> <td>         </td> <td>         </td> <td>3.41948e+06</td>
        </tr>
        <tr>
            <td>D       </td> <td>         </td> <td>         </td> <td>3.19945e+06</td>
        </tr>
        <tr>
            <td>G       </td> <td>         </td> <td>         </td> <td>3.0182e+06 </td>
        </tr>
        <tr>
            <td>LW      </td> <td>         </td> <td>         </td> <td>3.29887e+06</td>
        </tr>
        <tr>
            <td>RW      </td> <td>         </td> <td>         </td> <td>3.02728e+06</td>
        </tr>
    </tbody>
</table></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/03/2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../1/Index-Slice.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.1. </span>Selecting and Sorting</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-the-number-in-each-category">3.2.1. Counting the Number in Each Category</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-a-characteristic-of-each-category">3.2.2. Finding a Characteristic of Each Category</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-nhl-salaries">3.2.3. Example: NHL Salaries</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Rejwana Haque
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>